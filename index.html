<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S√∫per Academia MEGA 5.0</title>
    <link href="https://fonts.googleapis.com/css2?family=Andika&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --azul: #2980b9; --verde: #27ae60; --naranja: #f39c12; 
            --rojo: #e74c3c; --purpura: #8e44ad; --rosa: #fd79a8; 
            --cyan: #00cec9; --oro: #f1c40f; --fondo: #dfe6e9;
        }
        body { font-family: 'Andika', sans-serif; background: var(--fondo); margin: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; overflow: hidden; }
        #app { background: white; width: 95%; max-width: 1000px; height: 92vh; padding: 20px; border-radius: 40px; box-shadow: 0 25px 60px rgba(0,0,0,0.2); text-align: center; position: relative; display: flex; flex-direction: column; border: 5px solid white; box-sizing: border-box; }
        
        .grid-menu { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 10px; overflow-y: auto; }
        .btn-menu { padding: 15px; font-size: 16px; border: none; border-radius: 20px; color: white; font-weight: bold; cursor: pointer; transition: 0.3s; display: flex; flex-direction: column; align-items: center; box-shadow: 0 6px 0 rgba(0,0,0,0.1); }
        .btn-menu span { font-size: 35px; margin-bottom: 5px; }
        .btn-menu:active { transform: translateY(4px); box-shadow: none; }

        .hidden { display: none !important; }
        
        .grid-abc { display: grid; grid-template-columns: repeat(auto-fill, minmax(75px, 1fr)); gap: 10px; padding: 10px; overflow-y: auto; max-height: 450px; }
        .letra-card { background: #fdfdfd; border: 3px solid var(--azul); border-radius: 15px; padding: 15px; font-size: 30px; cursor: pointer; color: var(--azul); font-weight: bold; }
        .letra-card:hover { background: var(--azul); color: white; transform: scale(1.05); }

        .input-mega { font-size: 50px; border: 5px solid var(--azul); border-radius: 25px; text-align: center; width: 70%; padding: 10px; outline: none; margin: 10px 0; background: #f1f2f6; }
        .emoji-big { font-size: 100px; margin: 10px; animation: bounce 2s infinite; }
        @keyframes bounce { 0%, 100% {transform: translateY(0);} 50% {transform: translateY(-10px);} }

        #arcade-container { width: 100%; flex-grow: 1; background: #2d3436; border-radius: 30px; position: relative; overflow: hidden; }
        .burbuja { position: absolute; width: 70px; height: 70px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 30px; color: white; font-weight: bold; cursor: pointer; transition: 0.1s; }

        .btn-volver { background: #636e72; color: white; border: none; padding: 12px 30px; border-radius: 50px; cursor: pointer; margin-top: 10px; font-weight: bold; }
        
        #modal-abc { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 100; display: flex; flex-direction: column; align-items: center; justify-content: center; transform: scale(0); transition: 0.4s; border-radius: 40px; }
        #modal-abc.active { transform: scale(1); }
    </style>
</head>
<body>

<div id="app">
    <div id="view-menu">
        <h1 style="color: var(--azul); margin: 5px;">üöÄ MEGA ACADEMIA 5.0</h1>
        <div class="grid-menu">
            <button class="btn-menu" style="background:var(--naranja)" onclick="abrirABC()"><span>üÖ∞Ô∏è</span>1. ABECEDARIO</button>
            <button class="btn-menu" style="background:var(--verde)" onclick="irJuego('completar')"><span>‚úèÔ∏è</span>2. COMPLETAR</button>
            <button class="btn-menu" style="background:var(--purpura)" onclick="irJuego('dictado')"><span>üìù</span>3. DICTADO</button>
            <button class="btn-menu" style="background:var(--rosa)" onclick="irJuego('lectura')"><span>‚ö°</span>4. LECTURA</button>
            <button class="btn-menu" style="background:var(--cyan)" onclick="irJuego('comprension')"><span>üß†</span>5. COMPRENSI√ìN</button>
            <button class="btn-menu" style="background:var(--oro); color:#2d3436" onclick="iniciarArcade()"><span>üéÆ</span>6. BURBUJAS</button>
        </div>
    </div>

    <div id="view-abc" class="hidden">
        <h2>Toca las letras</h2>
        <div class="grid-abc" id="abc-grid"></div>
        <button class="btn-volver" onclick="irMenu()">‚¨Ö Volver</button>
        <div id="modal-abc">
            <div id="m-letra" style="font-size:150px; color:var(--azul); font-weight:bold;"></div>
            <div id="m-emoji" style="font-size:100px;"></div>
            <div id="m-texto" style="font-size:40px; color:var(--naranja); font-weight:bold;"></div>
            <button class="btn-volver" onclick="cerrarABC()" style="background:var(--rojo); padding: 15px 40px;">CERRAR</button>
        </div>
    </div>

    <div id="view-game" class="hidden" style="flex-grow:1; display:flex; flex-direction:column; justify-content:center; align-items:center;">
        <div id="game-content"></div>
        <button class="btn-volver" onclick="irMenu()">‚¨Ö Volver</button>
    </div>

    <div id="view-arcade" class="hidden" style="flex-grow:1; display:flex; flex-direction:column;">
        <div style="font-size: 24px; font-weight: bold; color: var(--azul);">Puntos: <span id="pts">0</span> | Vidas: <span id="vidas">3</span></div>
        <div id="arcade-container"></div>
        <button class="btn-volver" onclick="pararArcade()">‚¨Ö Salir</button>
    </div>
</div>

<script>
    const datosABC = {
        'A':['Avi√≥n','‚úàÔ∏è'],'B':['Ballena','üêã'],'C':['Cebra','ü¶ì'],'D':['Delf√≠n','üê¨'],'E':['Elefante','üêò'],
        'F':['Foca','ü¶≠'],'G':['Gato','üê±'],'H':['Helado','üç¶'],'I':['Iguana','ü¶é'],'J':['Jirafa','ü¶í'],
        'K':['Koala','üê®'],'L':['Le√≥n','ü¶Å'],'M':['Mariposa','ü¶ã'],'N':['Naranja','üçä'],'√ë':['√ëand√∫','üê¶'],
        'O':['Oveja','üêë'],'P':['Perro','üê∂'],'Q':['Queso','üßÄ'],'R':['Rat√≥n','üê≠'],'S':['Serpiente','üêç'],
        'T':['Tigre','üêØ'],'U':['Unicornio','ü¶Ñ'],'V':['Vaca','üêÑ'],'W':['Waffle','üßá'],'X':['Xil√≥fono','üéπ'],
        'Y':['Yate','üõ•Ô∏è'],'Z':['Zorro','ü¶ä']
    };

    const nivelesComp = [
        {f:"MAMA", e:"üë©‚Äçüë¶", p:"_AMA", r:"M"}, {f:"PATO", e:"ü¶Ü", p:"PA_O", r:"T"},
        {f:"LUNA", e:"üåô", p:"_UNA", r:"L"}, {f:"NENE", e:"üë∂", p:"NE_E", r:"N"},
        {f:"SAPO", e:"üê∏", p:"SA_O", r:"P"}, {f:"DADO", e:"üé≤", p:"DA_O", r:"D"},
        {f:"GATO", e:"üê±", p:"_ATO", r:"G"}, {f:"ROSA", e:"üåπ", p:"R_SA", r:"O"}
    ];

    const nivelesLectura = [
        {t: "EL SOL", s: "EL SOL ES AMARILLO Y CALIENTE"},
        {t: "MI GATO", s: "MI GATO ES MUY PEQUE√ëO Y LINDO"},
        {t: "LA VACA", s: "LA VACA NOS DA LECHE RICA"},
        {t: "EL MAR", s: "EL MAR TIENE MUCHOS PECES AZULES"}
    ];

    const nivelesEntender = [
        {f: "El mono come banana", o: ["üêò", "üêí", "ü¶í"], c: "üêí"},
        {f: "Me gusta comer helado", o: ["üç¶", "ü•¶", "ü™®"], c: "üç¶"},
        {f: "El p√°jaro vuela en el cielo", o: ["üêü", "üê¶", "üê¢"], c: "üê¶"},
        {f: "La rana salta en el agua", o: ["ü¶Å", "üê∏", "üêª"], c: "üê∏"}
    ];

    let lvl = 0; let pts = 0; let arcadeActivo = false; let vidas = 3;

    function decir(t) { window.speechSynthesis.cancel(); const m = new SpeechSynthesisUtterance(t); m.lang='es-ES'; m.rate=0.85; window.speechSynthesis.speak(m); }

    function irMenu() { 
        arcadeActivo = false; lvl = 0;
        document.querySelectorAll('#app > div').forEach(d => d.classList.add('hidden'));
        document.getElementById('view-menu').classList.remove('hidden');
    }

    function abrirABC() {
        document.getElementById('view-menu').classList.add('hidden');
        document.getElementById('view-abc').classList.remove('hidden');
        const g = document.getElementById('abc-grid'); g.innerHTML = "";
        Object.keys(datosABC).forEach(l => {
            const b = document.createElement('div'); b.className="letra-card"; b.innerText=l;
            b.onclick = () => {
                document.getElementById('m-letra').innerText = l;
                document.getElementById('m-emoji').innerText = datosABC[l][1];
                document.getElementById('m-texto').innerText = l + " de " + datosABC[l][0].toUpperCase();
                document.getElementById('modal-abc').classList.add('active');
                decir(l + "... de... " + datosABC[l][0]);
                confetti();
            };
            g.appendChild(b);
        });
        decir("Toca las letras para aprender.");
    }
    function cerrarABC() { document.getElementById('modal-abc').classList.remove('active'); }

    function irJuego(t) {
        lvl = 0; // Resetear nivel al entrar
        document.getElementById('view-menu').classList.add('hidden');
        document.getElementById('view-game').classList.remove('hidden');
        renderJuego(t);
    }

    function renderJuego(t) {
        const cont = document.getElementById('game-content');
        cont.innerHTML = "";
        
        if(t === 'completar') {
            if(lvl >= nivelesComp.length) return fin();
            const n = nivelesComp[lvl];
            cont.innerHTML = `<div class="emoji-big">${n.e}</div><div style="font-size:50px">${n.p.replace('_','<input id="in" class="input-mega" style="width:80px" maxlength="1">')}</div><button class="btn-menu" style="background:var(--verde); width:auto; display:inline;" onclick="checkC()">¬°LISTO!</button>`;
            decir("¬øQu√© letra falta?");
        }
        else if(t === 'dictado') {
            if(lvl >= nivelesComp.length) return fin();
            const n = nivelesComp[lvl];
            cont.innerHTML = `<div class="emoji-big">${n.e}</div><input id="in-d" class="input-mega" placeholder="Escribe..."><br><button class="btn-menu" style="background:var(--purpura); width:auto; display:inline;" onclick="decir('${n.f}')">üîä OIR</button> <button class="btn-menu" style="background:var(--verde); width:auto; display:inline;" onclick="checkD()">LISTO</button>`;
            decir("Escribe la palabra " + n.f);
        }
        else if(t === 'lectura') {
            if(lvl >= nivelesLectura.length) return fin();
            const n = nivelesLectura[lvl];
            cont.innerHTML = `<h2 style="color:var(--rosa)">${n.t}</h2><div style="font-size:30px; background:#fff; padding:20px; border-radius:20px; cursor:pointer;" onclick="decir('${n.s}')">${n.s}</div><button class="btn-menu" style="background:var(--rosa); width:auto; display:inline; margin-top:10px;" onclick="lvl++; renderJuego('lectura'); confetti();">SIGUIENTE ‚úÖ</button>`;
            decir("Lee esta frase muy fuerte.");
        }
        else if(t === 'comprension') {
            if(lvl >= nivelesEntender.length) return fin();
            const n = nivelesEntender[lvl];
            let opcionesHTML = n.o.map(o => `<span style="font-size:80px; cursor:pointer; margin:10px;" onclick="checkE('${o}','${n.c}')">${o}</span>`).join('');
            cont.innerHTML = `<h2 style="font-size:30px">${n.f}</h2><div>${opcionesHTML}</div><button class="btn-menu" style="background:var(--cyan); width:auto; display:inline;" onclick="decir('${n.f}')">üîä OIR</button>`;
            decir("Busca el dibujo de la oraci√≥n.");
        }
    }

    function checkC() { if(document.getElementById('in').value.toUpperCase() === nivelesComp[lvl].r) { lvl++; renderJuego('completar'); confetti(); decir("¬°Muy bien!"); } else decir("Casi, intenta otra vez"); }
    function checkD() { if(document.getElementById('in-d').value.toUpperCase() === nivelesComp[lvl].f) { lvl++; renderJuego('dictado'); confetti(); decir("¬°Genio!"); } else decir("Escucha de nuevo"); }
    function checkE(o, c) { if(o === c) { lvl++; renderJuego('comprension'); confetti(); decir("¬°Correcto!"); } else decir("Ese no es"); }
    function fin() { document.getElementById('game-content').innerHTML = "<h1>üèÜ ¬°ERES UN S√öPER EXPERTO!</h1>"; decir("¬°Felicidades! Lo lograste."); }

    function iniciarArcade() {
        irMenu();
        document.getElementById('view-menu').classList.add('hidden');
        document.getElementById('view-arcade').classList.remove('hidden');
        pts = 0; vidas = 3; arcadeActivo = true;
        actualizarArcade();
        bucleArcade();
    }
    function actualizarArcade() { document.getElementById('pts').innerText = pts; document.getElementById('vidas').innerText = vidas; }
    function bucleArcade() {
        if(!arcadeActivo) return;
        const cont = document.getElementById('arcade-container');
        const b = document.createElement('div');
        const esBomba = Math.random() < 0.2;
        b.className = "burbuja";
        b.innerText = esBomba ? "üí£" : "ABCDE"[Math.floor(Math.random()*5)];
        b.style.left = Math.random() * (cont.offsetWidth - 70) + "px";
        b.style.top = "-70px";
        b.style.backgroundColor = esBomba ? "black" : `hsl(${Math.random()*360}, 70%, 50%)`;
        cont.appendChild(b);

        let t = -70;
        const anim = setInterval(() => {
            if(!arcadeActivo) { clearInterval(anim); return; }
            t += 3 + (pts/10); b.style.top = t + "px";
            if(t > cont.offsetHeight) {
                clearInterval(anim); if(b.parentElement) cont.removeChild(b);
                if(!esBomba && arcadeActivo) { /* Se puede penalizar si se desea */ }
            }
        }, 30);

        b.onclick = () => {
            if(esBomba) { decir("¬°Oh no!"); vidas--; pts = Math.max(0, pts-5); }
            else { decir(b.innerText); pts++; }
            actualizarArcade();
            clearInterval(anim); if(b.parentElement) cont.removeChild(b);
            if(vidas <= 0) { decir("Fin del juego"); arcadeActivo = false; irMenu(); }
        };
        setTimeout(bucleArcade, 1200 - Math.min(pts*10, 800));
    }
    function pararArcade() { arcadeActivo = false; irMenu(); }
</script>
</body>
</html>